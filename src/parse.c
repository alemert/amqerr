/******************************************************************************/
/*                                                                            */
/*   A M Q E R R   T O   Q U E U E                                            */
/*                                                                            */
/*  ------------------------------------------------------------------------  */
/*                                                                            */
/*  file: parse.c                                                             */
/*                                                                            */
/*  functions:                                                                */
/*    - parseFile800                        */
/*                                                  */
/*  history:                                */
/*                                                */
/******************************************************************************/

/******************************************************************************/
/*   I N C L U D E S                                                          */
/******************************************************************************/

// ---------------------------------------------------------
// system
// ---------------------------------------------------------
#include <stdio.h>
#include <string.h>

// ---------------------------------------------------------
// own 
// ---------------------------------------------------------
#include <ctl.h>

// ---------------------------------------------------------
// local
// ---------------------------------------------------------
#include <amqerr.h>

/******************************************************************************/
/*   G L O B A L S                                                            */
/******************************************************************************/

/******************************************************************************/
/*   D E F I N E S                                                            */
/******************************************************************************/

/******************************************************************************/
/*   M A C R O S                                                              */
/******************************************************************************/

/******************************************************************************/
/*   P R O T O T Y P E S                                                      */
/******************************************************************************/

/******************************************************************************/
/*                                                                            */
/*   F U N C T I O N S                                                        */
/*                                                                            */
/******************************************************************************/

/******************************************************************************/
/*  P A R S E   F I L E   8 0 0                                               */
/*                                                                            */
/*  description:                                                              */
/*    parse AMQERR file with MQ Version 8.0                                   */
/*                                                                            */
/*  attributes:                                                               */
/*    - opened file pointer                                                   */ 
/*                                                                            */
/*  return code:                                                              */
/*    OK  -> bytes read                                                       */
/*    ERR -> reason < 0                                                       */
/*                                                                            */
/******************************************************************************/
int parseFile800( FILE* _fp )
{
  logFuncCall( );

  char buff[AMQERR_LINE_SIZE] ;

  int sysRc ;

  tAmqerrMessage msg;

  struct tm ti;

  // -------------------------------------------------------  
  // Time Stamp, PID, User, Program
  // -------------------------------------------------------  
  if( !fgets(buff,AMQERR_LINE_SIZE, _fp) ) goto _door;
  
  {
    char *time = strtok( buff,"-" );
                         printf("time >%s<\n",time) ;
    char *pid = strtok(NULL,"(");
                         printf("pid  >%s<\n",pid) ;
         *pid = strtok(NULL,")");
                         printf("pid  >%s<\n",pid) ;
    char *usr = strtok(NULL," ");
    char *prg = strtok(NULL,"\n");
#if(1)

    printf("user >%s<\n",usr) ;
    printf("prg  >%s<\n",prg) ;
#endif
  }

  while( fgets(buff,AMQERR_LINE_SIZE, _fp))
  {
    printf("%s",buff);
  }

  _door :

  logFuncExit( );

  return sysRc ;
}

